도커 엔진은 "도커 이미지를 생성하고 컨테이너를 실행하는 핵심 기능"

### 2.1 도커 이미지와 컨테이너
- 도커 이미지는 서비스 운영에 필요한 서버 프로그램, 소스코드 및 라이브러리, 컴파일된 실행 파일을 묶는 형태이고 도커 컨테이너는 이미지를 실행한 상태로, 응용프로그램의 종속성과 함께 응용프로그램 자체를 패키징 or 캡슐화하여 격리된 공간에서 프로세스를 동작시키는 기술
### 2.2 도커 컨테이너 다루기
- 도커 GUI 지원하는 Kitematic
- 대부분의 서비스는 단일프로그램으로 동작하지않고, 여러개가 연결되어 동작하는데 서비스를 한 컨테이너에 설치하는 것보다 각 컨테이너로 설치하면 독립성과 모듈화에 최적
도커 볼륨
- 도커 이미지는 읽기전용 도커 컨테이너는 쓰기가 가능해지는데 변경사항은 별도로 저장해서 각 컨테이너에 정보를 저장 및 보존해서 컨테이너 삭제시 데이터가 날아갈수 있는데 이 단점을 해결하기 위해서 도커 볼륨을 활용
- 호스트와 볼륨 공유, 볼륨 컨테이너 활용, 도커가 관리하는 볼륨 생성
~~~
-v [호스트 공유 디렉토리]:[컨테이너 공유 디렉토리] 
~~~
~~~
-v [볼륨명]:[컨테이너 공유 디렉토리]
~~~
- -v 명령어 대신 -mount 명령어로도 사용 가능

#### 도커 네트워크 구조
![image](https://user-images.githubusercontent.com/38122225/129666867-a40a9289-11e5-4850-b65f-3a2ce1b3561d.png)
<br>
[참조](https://jonnung.dev/docker/2020/02/16/docker_network/)

### 2.4 Dockerfile
- 개발한 애플리케이션을 컨테이너화할땐 컨테이너 생성 환경 설치 후 동작을 확인, 컨테이너를 이미지로 커밋하는 방식 하지만 매번 수작업으로 진행해야하기 때문에 보통 도커에서는 build 명령어를 제공
- build하는 작업을 기록한 것을 Dockerfile이라고 부르며, build 명령어는 Dockerfile을 읽어서 이미지를 생성
- Dockerfile을 사용하면 매번 이미지를 커밋해야하는 귀찮은 일이 줄어들고, 개발도구(깃)를 통해 애플리케이션 빌드 및 배포를 자동화

|명령어|의미|
|:---:|:---|
|FROM|생성할 이미지의 베이스가될 이미지를 의미|
|MAINTAINER|이미지를 생성한 개발자의 정보, 1.13.0 이후로 사용 X|
|LABEL|이미지에 메타데이터 추가, docker inspect 명령어로 이미지 정보에서 확인|
|RUN|이미지를 만들기 위해 컨테이너 내부에서 명령어를 실행|
|ADD|파일을 이미지에 추가|
|WORKDIR|명령어를 실행할 디렉토리를 지정|
|EXPOSE|Dockerfile의 빌드로 생성된 이미지에서 노출할 포트를 설정|
|CMD|컨테이너가 시작될 때마다 실행할 명령어를 설정, Dockerfile에서 한번만 사용가능|
|COPY, ADD|호스트OS에서 파일또는 디렉토리를 컨테이너 안 경로로 복사, ADD의 경우 원격 파일 다운로드 또는 축해제 등과 같은 기능이 존재|
|USER|명령을 실행할 사용자 계정을 설정, RUN, CMD, ENTRYPOINT에 적용|

#### 도커 Port forwaring, Port mapping
- 외부 주소와 내부 주소를 이어주는 역할
- -p [호스트 포트]:[컨테이너 포트]/[프로토콜 유형] 프로토콜 유형은 생략가능 생략시 TCP로 기본 적용
- docker run -p 옵션으로 호스트 포트와 컨테이너 포트를 명시적으로 지정이 가능하지만, Dockerfile의 EXPOSE 명령어는 컨테이너 포트만 지정할 뿐이며, 호스트 포트는 -p 옵션으로 호스트 포트를 명시적으로 지정해주던지 생략시 랜덤 호스트포트가 EXPOSE에 설정한 컨테이너 포트로 매핑
